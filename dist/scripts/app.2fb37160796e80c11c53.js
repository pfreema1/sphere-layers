(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{319:function(e,n,t){"use strict";t.r(n);var a=t(313),i=t(314),r=t.n(i),o=t(315),s=t.n(o),u=t(316),l=t.n(u);t(317);function h(e,n,t,a,i,r,o){try{var s=e[r](o),u=s.value}catch(e){return void t(e)}s.done?n(u):Promise.resolve(u).then(a,i)}function m(e,n){for(var t=0;t<n.length;t++){var a=n[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var c=function(){function e(n){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this.app=n,this.PARAMS={rotSpeed:.001},this.init()}var n,t,i,o,u;return n=e,(t=[{key:"init",value:(o=regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.initThree(),this.initBgScene(),this.initLights(),e.next=5,this.loadMesh();case 5:this.setupMaterial(),this.createMultipleSpheres(),this.initRenderTri(),this.setupMouseListener();case 9:case"end":return e.stop()}}),e,this)})),u=function(){var e=this,n=arguments;return new Promise((function(t,a){var i=o.apply(e,n);function r(e){h(i,t,a,r,s,"next",e)}function s(e){h(i,t,a,r,s,"throw",e)}r(void 0)}))},function(){return u.apply(this,arguments)})},{key:"setupMouseListener",value:function(){var e=this;this.mouse=new a.Vector2,this.width=window.innerWidth,this.height=window.innerHeight,document.addEventListener("mousemove",(function(n){var t=n.clientX,a=n.clientY;e.mouse.x=t/e.width*2-1,e.mouse.y=-a/e.height*2+1}))}},{key:"initTweakPane",value:function(){this.pane=new l.a,this.pane.addInput(this.PARAMS,"rotSpeed",{min:0,max:.5}).on("change",(function(e){}))}},{key:"createMultipleSpheres",value:function(){this.spheres=[],this.numSpheres=5;for(var e=0;e<this.numSpheres;e++){var n=this.testMesh.clone();this.bgScene.add(n),n.scale.set(1*e,1*e,1*e),this.spheres.push(n)}console.log(this.spheres)}},{key:"initThree",value:function(){this.scene=new a.Scene,this.camera=new a.OrthographicCamera,this.renderer=new a.WebGLRenderer({antialias:!0,alpha:!0}),this.renderer.autoClear=!0,this.clock=new a.Clock}},{key:"loadMesh",value:function(){var e=this;return new Promise((function(n,t){(new r.a).load("./sphere-layers.glb",(function(t){e.testMesh=t.scene.children[0],console.log(e.testMesh),e.testMesh.scale.set(15,15,15),e.bgScene.add(e.testMesh),n()}))}))}},{key:"setupMaterial",value:function(){var e=new a.ShaderMaterial({fragmentShader:s()("#define GLSLIFY 1\nfloat map(float value, float inMin, float inMax, float outMin, float outMax) {\n  return outMin + (outMax - outMin) * (value - inMin) / (inMax - inMin);\n}\n\nvec2 map(vec2 value, vec2 inMin, vec2 inMax, vec2 outMin, vec2 outMax) {\n  return outMin + (outMax - outMin) * (value - inMin) / (inMax - inMin);\n}\n\nvec3 map(vec3 value, vec3 inMin, vec3 inMax, vec3 outMin, vec3 outMax) {\n  return outMin + (outMax - outMin) * (value - inMin) / (inMax - inMin);\n}\n\nvec4 map(vec4 value, vec4 inMin, vec4 inMax, vec4 outMin, vec4 outMax) {\n  return outMin + (outMax - outMin) * (value - inMin) / (inMax - inMin);\n}\n\nvarying vec3 vNormal;\nvarying vec2 vUv;\nuniform float u_time;\nuniform sampler2D u_texture;\nuniform vec2 uMouse;\n\nvarying vec3 fragPos;\n\nvoid main() {\n  vec2 st = vUv;  \n  vec3 color = vec3(1.0);\n  vec2 pos = vec2(st * 300.0);\n  vec3 outsideColor = vec3(0.0);\n  vec4 textureColor = texture2D(u_texture, vUv);\n\n  float lightX = map(uMouse.x, -1.0, 1.0, -2.2, 2.2);\n  float lightY = map(uMouse.y, -1.0, 1.0, -2.0, 2.0);\n  float lightZ = sin(u_time) * 3.0;\n  vec3 lightPos = vec3(lightX, lightY, lightZ);\n  vec3 norm = normalize(vNormal);\n  vec3 lightDir = normalize(lightPos - fragPos);\n  float diff = max(dot(norm, lightDir), 0.0);\n\n  color = mix(color, outsideColor, 1.0 - diff);\n\n  // color = vec3(diff);\n  gl_FragColor = vec4(color, 1.0);\n}"),vertexShader:s()("#define GLSLIFY 1\nfloat inverse(float m) {\n  return 1.0 / m;\n}\n\nmat2 inverse(mat2 m) {\n  return mat2(m[1][1],-m[0][1],\n             -m[1][0], m[0][0]) / (m[0][0]*m[1][1] - m[0][1]*m[1][0]);\n}\n\nmat3 inverse(mat3 m) {\n  float a00 = m[0][0], a01 = m[0][1], a02 = m[0][2];\n  float a10 = m[1][0], a11 = m[1][1], a12 = m[1][2];\n  float a20 = m[2][0], a21 = m[2][1], a22 = m[2][2];\n\n  float b01 = a22 * a11 - a12 * a21;\n  float b11 = -a22 * a10 + a12 * a20;\n  float b21 = a21 * a10 - a11 * a20;\n\n  float det = a00 * b01 + a01 * b11 + a02 * b21;\n\n  return mat3(b01, (-a22 * a01 + a02 * a21), (a12 * a01 - a02 * a11),\n              b11, (a22 * a00 - a02 * a20), (-a12 * a00 + a02 * a10),\n              b21, (-a21 * a00 + a01 * a20), (a11 * a00 - a01 * a10)) / det;\n}\n\nmat4 inverse(mat4 m) {\n  float\n      a00 = m[0][0], a01 = m[0][1], a02 = m[0][2], a03 = m[0][3],\n      a10 = m[1][0], a11 = m[1][1], a12 = m[1][2], a13 = m[1][3],\n      a20 = m[2][0], a21 = m[2][1], a22 = m[2][2], a23 = m[2][3],\n      a30 = m[3][0], a31 = m[3][1], a32 = m[3][2], a33 = m[3][3],\n\n      b00 = a00 * a11 - a01 * a10,\n      b01 = a00 * a12 - a02 * a10,\n      b02 = a00 * a13 - a03 * a10,\n      b03 = a01 * a12 - a02 * a11,\n      b04 = a01 * a13 - a03 * a11,\n      b05 = a02 * a13 - a03 * a12,\n      b06 = a20 * a31 - a21 * a30,\n      b07 = a20 * a32 - a22 * a30,\n      b08 = a20 * a33 - a23 * a30,\n      b09 = a21 * a32 - a22 * a31,\n      b10 = a21 * a33 - a23 * a31,\n      b11 = a22 * a33 - a23 * a32,\n\n      det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n  return mat4(\n      a11 * b11 - a12 * b10 + a13 * b09,\n      a02 * b10 - a01 * b11 - a03 * b09,\n      a31 * b05 - a32 * b04 + a33 * b03,\n      a22 * b04 - a21 * b05 - a23 * b03,\n      a12 * b08 - a10 * b11 - a13 * b07,\n      a00 * b11 - a02 * b08 + a03 * b07,\n      a32 * b02 - a30 * b05 - a33 * b01,\n      a20 * b05 - a22 * b02 + a23 * b01,\n      a10 * b10 - a11 * b08 + a13 * b06,\n      a01 * b08 - a00 * b10 - a03 * b06,\n      a30 * b04 - a31 * b02 + a33 * b00,\n      a21 * b02 - a20 * b04 - a23 * b00,\n      a11 * b07 - a10 * b09 - a12 * b06,\n      a00 * b09 - a01 * b07 + a02 * b06,\n      a31 * b01 - a30 * b03 - a32 * b00,\n      a20 * b03 - a21 * b01 + a22 * b00) / det;\n}\n\nfloat transpose(float m) {\n  return m;\n}\n\nmat2 transpose(mat2 m) {\n  return mat2(m[0][0], m[1][0],\n              m[0][1], m[1][1]);\n}\n\nmat3 transpose(mat3 m) {\n  return mat3(m[0][0], m[1][0], m[2][0],\n              m[0][1], m[1][1], m[2][1],\n              m[0][2], m[1][2], m[2][2]);\n}\n\nmat4 transpose(mat4 m) {\n  return mat4(m[0][0], m[1][0], m[2][0], m[3][0],\n              m[0][1], m[1][1], m[2][1], m[3][1],\n              m[0][2], m[1][2], m[2][2], m[3][2],\n              m[0][3], m[1][3], m[2][3], m[3][3]);\n}\n\nvarying vec3 vNormal;\nvarying vec2 vUv;\n\nvarying vec3 fragPos;\n\nvoid main() {\n  vNormal = mat3(transpose(inverse(modelMatrix))) * normal;\n  vUv = uv;\n\n  fragPos = vec3(modelMatrix * vec4(position, 1.0));\n\n  // vec3 modPos = mix(position, (position + (normal * 0.5)), vUv.x);\n\n  // gl_Position = projectionMatrix * modelViewMatrix * vec4(modPos,1.0);\n\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position,1.0);\n}"),uniforms:{u_time:{value:0},u_texture:{value:(new a.TextureLoader).load("./all-color.png",(function(e){e.flipY=!1,e.needsUpdate=!0}))},uMouse:{value:0}}});this.testMesh.material=this.testMeshMaterial=e,this.testMesh.material.needsUpdate=!0}},{key:"returnRenderTriGeometry",value:function(){var e=new a.BufferGeometry,n=new Float32Array([-1,-1,3,-1,-1,3]);return e.addAttribute("position",new a.BufferAttribute(n,2)),e}},{key:"initRenderTri",value:function(){this.resize();var e=this.returnRenderTriGeometry(),n=new a.Vector2;this.renderer.getDrawingBufferSize(n),this.RenderTriTarget=new a.WebGLRenderTarget(n.x,n.y,{format:a.RGBFormat,stencilBuffer:!1,depthBuffer:!0}),this.triMaterial=new a.RawShaderMaterial({fragmentShader:s()("precision highp float;\n#define GLSLIFY 1\nuniform sampler2D uScene;\nuniform vec2 uResolution;\nuniform float uTime;\n\nvoid main() {\n    vec2 uv = gl_FragCoord.xy / uResolution.xy;\n    vec4 color = texture2D(uScene, uv);\n\n    // wavy line\n    // float x = uv.x;\n    // float m = sin(x * 8.0 + uTime) * 0.3;\n    // uv.y -= m;\n    // float line = smoothstep(0.4, 0.5, uv.y) * smoothstep(0.6, 0.5, uv.y);\n    // color = mix(color, vec4(1.0), line);\n    \n    gl_FragColor = vec4(color);\n}"),vertexShader:s()("precision highp float;\n#define GLSLIFY 1\nattribute vec2 position;\n\nvoid main() {\n    // Look ma! no projection matrix multiplication,\n    // because we pass the values directly in clip space coordinates.\n    gl_Position = vec4(position, 1.0, 1.0);\n}"),uniforms:{uScene:{type:"t",value:this.bgRenderTarget.texture},uResolution:{value:n},uTime:{value:0}}}),console.log(this.bgRenderTarget.texture);var t=new a.Mesh(e,this.triMaterial);t.frustumCulled=!1,this.scene.add(t)}},{key:"initBgScene",value:function(){this.bgRenderTarget=new a.WebGLRenderTarget(window.innerWidth,window.innerHeight),this.bgCamera=new a.PerspectiveCamera(50,window.innerWidth/window.innerHeight,.01,100),this.bgCamera.position.z=6,this.bgScene=new a.Scene}},{key:"initLights",value:function(){}},{key:"resize",value:function(){this.renderer&&(this.camera.aspect=window.innerWidth/window.innerHeight,this.camera.updateProjectionMatrix(),this.fovHeight=2*Math.tan(this.camera.fov*Math.PI/180/2)*this.camera.position.z,this.fovWidth=this.fovHeight*this.camera.aspect,this.renderer.setSize(window.innerWidth,window.innerHeight),this.trackball&&this.trackball.handleResize())}},{key:"updateTestMesh",value:function(){this.testMesh.rotation.y+=this.PARAMS.rotSpeed}},{key:"updateSpheres",value:function(){for(var e=0;e<this.numSpheres;e++)this.spheres[e].rotation.y+=e%2?.001:-.001}},{key:"update",value:function(){this.clock.getDelta();var e=5e-4*performance.now();this.triMaterial&&(this.triMaterial.uniforms.uTime.value=e),this.testMeshMaterial&&(this.testMeshMaterial.uniforms.u_time.value=e,this.testMeshMaterial.uniforms.uMouse.value=this.mouse),this.testMesh&&this.updateTestMesh(),0!==this.spheres&&this.updateSpheres(),this.trackball&&this.trackball.update()}},{key:"draw",value:function(){this.renderer.setRenderTarget(this.bgRenderTarget),this.renderer.render(this.bgScene,this.bgCamera),this.renderer.setRenderTarget(null),this.renderer.render(this.scene,this.camera)}}])&&m(n.prototype,t),i&&m(n,i),e}();function v(e,n){for(var t=0;t<n.length;t++){var a=n[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}t.d(n,"default",(function(){return d}));var d=function(){function e(){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e)}var n,t,a;return n=e,(t=[{key:"init",value:function(){this.initWebGL(),this.addListeners(),this.animate(),this.resize()}},{key:"initWebGL",value:function(){this.webgl=new c(this),document.querySelector(".container").appendChild(this.webgl.renderer.domElement)}},{key:"addListeners",value:function(){this.handlerAnimate=this.animate.bind(this),window.addEventListener("resize",this.resize.bind(this)),window.addEventListener("keyup",this.keyup.bind(this))}},{key:"animate",value:function(e){this.update(),this.draw(),this.raf=requestAnimationFrame(this.handlerAnimate)}},{key:"update",value:function(){this.webgl&&this.webgl.update()}},{key:"draw",value:function(){this.webgl&&this.webgl.draw()}},{key:"resize",value:function(){this.webgl&&this.webgl.resize()}},{key:"keyup",value:function(e){82==e.keyCode&&this.webgl.trackball&&this.webgl.trackball.reset()}}])&&v(n.prototype,t),a&&v(n,a),e}()}}]);